<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control ESP32 - MQTT</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mqtt/4.3.7/mqtt.min.js"></script>
</head>
<body>
    <div class="rat-container">
        <svg class="rat" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
            <ellipse cx="50" cy="55" rx="25" ry="20" fill="#666"/>
            <ellipse cx="35" cy="45" rx="18" ry="16" fill="#777"/>
            <ellipse cx="28" cy="35" rx="8" ry="10" fill="#555"/>
            <ellipse cx="42" cy="35" rx="8" ry="10" fill="#555"/>
            <circle cx="30" cy="43" r="3" fill="#fff"/>
            <circle cx="40" cy="43" r="3" fill="#fff"/>
            <circle cx="31" cy="43" r="1.5" fill="#000"/>
            <circle cx="41" cy="43" r="1.5" fill="#000"/>
            <ellipse cx="35" cy="50" rx="3" ry="2" fill="#ffc0cb"/>
            <path d="M 75 55 Q 85 50, 90 55 Q 95 60, 90 65" stroke="#666" stroke-width="3" fill="none"/>
            <rect x="40" y="70" width="4" height="12" rx="2" fill="#666"/>
            <rect x="48" y="70" width="4" height="12" rx="2" fill="#666"/>
            <rect x="56" y="70" width="4" height="12" rx="2" fill="#666"/>
            <rect x="64" y="70" width="4" height="12" rx="2" fill="#666"/>
        </svg>
    </div>

    <div class="container">
        <div class="header">
            <h1>Control ESP32 - MQTT</h1>
            <div id="status" class="status disconnected">Desconectado del broker</div>
        </div>

        <div class="tabs">
            <div class="tab active" data-tab="connection">Conexión</div>
            <div class="tab" data-tab="console">Consola Serial</div>
            <div class="tab" data-tab="info">Información</div>
        </div>

        <div id="connection-tab" class="tab-content active">
            <h2>Conectividad</h2>
            <div class="input-group">
                <input type="text" id="robotName" placeholder="Nombre del Robot (Topic)" value="robot01">
                <button id="connectBtn">Conectar</button>
            </div>
            <div class="info-box">
                <h3>Instrucciones:</h3>
                <p>1. Ingresa el nombre del robot (este será el topic MQTT)</p>
                <p>2. Asegúrate de que tu ESP32 esté encendido y conectado</p>
                <p>3. Haz clic en "Conectar" para establecer la conexión</p>
                <p>4. Espera la confirmación del robot</p>
            </div>
        </div>

        <div id="console-tab" class="tab-content">
            <h2>Puerto Serial Virtual</h2>
            <div id="console" class="console"></div>
            <div class="input-group" style="margin-top: 15px;">
                <input type="text" id="messageInput" placeholder="Escribe un mensaje..." disabled>
                <button id="sendBtn" disabled>Enviar</button>
            </div>
            <button class="clear-btn">Limpiar Consola</button>
        </div>

        <div id="info-tab" class="tab-content">
            <h2>Información del Sistema</h2>
            <div class="info-box">
                <h3>Broker MQTT:</h3>
                <p>Host: 90246ea5b74141e783178f6a189a8171.s1.eu.hivemq.cloud</p>
                <p>Puerto: 8884 (WebSocket Secure)</p>
            </div>
            <div class="info-box">
                <h3>Topics:</h3>
                <p><strong>[nombre_robot]/cmd</strong> - Para enviar comandos al ESP32</p>
                <p><strong>[nombre_robot]/data</strong> - Para recibir datos del ESP32</p>
            </div>
            <div class="info-box">
                <h3>Comandos especiales:</h3>
                <p><strong>CONNECT</strong> - Inicia la conexión con el robot</p>
                <p><strong>CONNECTED</strong> - Respuesta del robot confirmando conexión</p>
            </div>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="console.js"></script>
    <script src="ui.js"></script>
    <script src="mqtt.js"></script>
</body>
</html>
